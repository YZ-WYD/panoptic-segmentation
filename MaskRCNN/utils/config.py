# -------------------------------------------------------------------------
# utils/config.py
# 全局配置中心
# -------------------------------------------------------------------------
import os

# =========================
#  1. 数据集与路径
# =========================
# 类别文件路径 (请确认该路径下有你的txt文件)
CLASSES_PATH = 'model_data/shengwulei_classes.txt'

# 预训练权重路径 (第一次训练时会自动下载resnet50，之后可以指向训练好的pth)
PRETRAIN_PATH = 'mask_rcnn_coco.pth'

# 训练结果保存目录
SAVE_DIR = 'logs_pytorch'

# =========================
#  2. 核心：数据流配置
# =========================
# 输入波段数 (3=RGB, 4=RGB+NIR 等)
NUM_BANDS = 3

# 归一化除数 (Scale Factor)
# - 如果是 8-bit 图片 (0-255)，设为 255.0
# - 如果是 16-bit 遥感影像 (0-10000+)，设为 10000.0 (或你数据的最大值)
# 逻辑: Input_Tensor = Raw_Image / IMAGE_DIVISOR
IMAGE_DIVISOR = 255.0

# 图片输入尺寸 (训练和预测时都会 Resize 到这个尺寸)
# 注意：Torchvision内部会自动处理多尺度，但为了显存可控，我们通常固定一个上限
IMAGE_MAX_DIM = 512

# =========================
#  3. 训练参数
# =========================
BATCH_SIZE = 2
INIT_EPOCH = 0
MAX_EPOCH = 100

# 学习率
INIT_LR = 1e-4
MIN_LR = INIT_LR * 0.01

# RPN Anchor 设置 (根据目标大小调整，单位是像素)
# 如果目标很小，可以把数字改小，如 (16, 32, 64, 128, 256)
RPN_ANCHOR_SCALES = (32, 64, 128, 256, 512)